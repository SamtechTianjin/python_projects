#!/usr/bin/expect

set timeout 20
set IP [lindex $argv 0]
set username [lindex $argv 1]
set password [lindex $argv 2]

spawn ssh-copy-id -i /$username/.ssh/id_rsa.pub $username@$IP
expect {
    "*yes/no*" { send "yes\r"; exp_continue }
    "*password:" { send "$password\r"; exp_continue }
    "]#" { send "\r"}
    }
exit
